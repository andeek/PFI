---
title: "PFI Exploratory"
author: "Evan “Pete” Walsh"
date: "October 15, 2014"
output: html_document
---

>Load data and libraries.

```{r message=FALSE}
pfi <- read.csv("/Users/marianwaitwalsh/GitHub/PFI/data/PFI_clean.csv")
library(dplyr)
library(reshape2)
library(ggplot2)
```

>Variables are grouped into five different categories, denoted by ```item_type```. These categories are ```Derived```, ```Expense```, ```Revenue```, ```Unit Price```, and ```Unit Quantity```.

```{r}
unique(pfi$item_type)
```

>Let's look at the ```Derived``` variables first.

```{r warning=FALSE}
derived <- pfi %>%
  filter(item_type == "Derived") %>%
  group_by(field_id, year)
derived
# Total expenses divided by yield (Cost per bushel or pound).
derived2 <- subset(derived, item=="Cost_per_bu_Or_pound")
qplot(year, value, data=derived2, facets=~field_id, colour=crop) + 
  ylab("Cost / bu or #")
# Net income excluding the cost of labor.
derived3 <- subset(derived, item=="Labor_Return")
qplot(year, value, data=derived3, facets=~field_id, colour=crop) +
  ylab("Labor return")
# Net income excluding the cost of labor and management.
derived4 <- subset(derived, item=="LaborandMR_dollar_per_A")
qplot(year, value, data=derived4, facets=~field_id, colour=crop) + 
  ylab("Labor & MR $ / acre")
```

>Crop yields per acre in bushels or pounds.

```{r}
yields <- pfi %>%
  filter(item_type == "Unit Quantity") %>%
  group_by(field_id, year)
yields2 <- dcast(yields, field_id + year ~ crop, value.var = "value")
yields2 <- yields2[,1:6]
mean(yields2$Corn, na.rm=T)
mean(yields2$Hay, na.rm=T)
mean(yields2$Oats, na.rm=T)
mean(yields2$SB, na.rm=T)
```

